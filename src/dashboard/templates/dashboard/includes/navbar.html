<nav class="main-header navbar navbar-expand">
    <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link" data-widget="pushmenu" href="#"><i class="fas fa-bars"></i></a>
        </li>
        <li class="nav-item d-none d-sm-inline-block">
            <a href="{% url 'dashboard:index' %}" class="nav-link">Главная</a>
        </li>
    </ul>

    <ul class="navbar-nav ms-auto">
        <li class="nav-item">
            <div class="theme-switch-wrapper nav-link">
                <label class="theme-switch" for="checkbox">
                    <input type="checkbox" id="checkbox">
                    <span class="slider round" data-text-light="Сменить тему" data-text-dark="Сменить тему">
                        Сменить тему
                    </span>
                </label>
            </div>
        </li>
    </ul>
</nav>

<script>
    const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
    const themeText = document.querySelector('.theme-switch .slider');
    const mainHeader = document.querySelector('.main-header');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const currentTheme = localStorage.getItem('theme') || (prefersDark ? 'dark' : 'light');

    function applyTheme(theme) {
        const isDark = theme === 'dark';

        document.body.classList.toggle('dark-mode', isDark);

        // Переключаем стили навбара
        mainHeader.classList.toggle('navbar-dark', isDark);
        mainHeader.classList.toggle('navbar-light', !isDark);

        mainHeader.classList.toggle('bg-dark', isDark);
        mainHeader.classList.toggle('bg-white', !isDark);

        mainHeader.classList.toggle('text-white', isDark);
        mainHeader.classList.toggle('text-dark', !isDark);

        toggleSwitch.checked = isDark;

        if (themeText) {
            themeText.textContent = isDark
                ? themeText.getAttribute('data-text-dark')
                : themeText.getAttribute('data-text-light');
        }
    }

    function switchTheme(e) {
        const theme = e.target.checked ? 'dark' : 'light';
        localStorage.setItem('theme', theme);
        applyTheme(theme);
    }

    // Применить при загрузке
    applyTheme(currentTheme);

    // Обработчик
    toggleSwitch.addEventListener('change', switchTheme, false);
</script>